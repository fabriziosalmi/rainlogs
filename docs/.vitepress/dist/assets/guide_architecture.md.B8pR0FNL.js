import{_ as a,o as r,c as t,ag as o}from"./chunks/framework.DRvAPM3c.js";const u=JSON.parse('{"title":"Architecture","description":"","frontmatter":{},"headers":[],"relativePath":"guide/architecture.md","filePath":"guide/architecture.md"}'),n={name:"guide/architecture.md"};function i(s,e,l,d,c,g){return r(),t("div",null,[...e[0]||(e[0]=[o('<h1 id="architecture" tabindex="-1">Architecture <a class="header-anchor" href="#architecture" aria-label="Permalink to &quot;Architecture&quot;">​</a></h1><p>Rainlogs is built on a modern, robust stack designed for high performance, security, and compliance.</p><h2 id="core-components" tabindex="-1">Core Components <a class="header-anchor" href="#core-components" aria-label="Permalink to &quot;Core Components&quot;">​</a></h2><h3 id="_1-go-1-24-backend" tabindex="-1">1. Go 1.24 Backend <a class="header-anchor" href="#_1-go-1-24-backend" aria-label="Permalink to &quot;1. Go 1.24 Backend&quot;">​</a></h3><p>The core API and background workers are written in Go 1.24. It leverages the standard library&#39;s <code>net/http</code> package with enhanced routing capabilities introduced in Go 1.22.</p><h3 id="_2-postgresql" tabindex="-1">2. PostgreSQL <a class="header-anchor" href="#_2-postgresql" aria-label="Permalink to &quot;2. PostgreSQL&quot;">​</a></h3><p>The primary relational database used for storing metadata, user accounts, and configuration.</p><h3 id="_3-redis-asynq" tabindex="-1">3. Redis &amp; Asynq <a class="header-anchor" href="#_3-redis-asynq" aria-label="Permalink to &quot;3. Redis &amp; Asynq&quot;">​</a></h3><p>Redis is used as the backing store for <a href="https://github.com/hibiken/asynq" target="_blank" rel="noreferrer">Asynq</a>, a robust task queue library for Go. Asynq handles background jobs such as:</p><ul><li>Fetching logs from Cloudflare.</li><li>Processing and encrypting logs.</li><li>Uploading logs to S3.</li><li>Enforcing data retention policies (e.g., deleting logs older than 395 days).</li></ul><h3 id="_4-garage-s3" tabindex="-1">4. Garage S3 <a class="header-anchor" href="#_4-garage-s3" aria-label="Permalink to &quot;4. Garage S3&quot;">​</a></h3><p><a href="https://garagehq.deuxfleurs.fr/" target="_blank" rel="noreferrer">Garage</a> is an open-source, distributed object storage system that implements the S3 API. It is designed for self-hosting and provides a sovereign alternative to AWS S3. Rainlogs uses Garage as its primary storage backend for logs.</p><h3 id="_5-asynqmon" tabindex="-1">5. Asynqmon <a class="header-anchor" href="#_5-asynqmon" aria-label="Permalink to &quot;5. Asynqmon&quot;">​</a></h3><p>A web UI for monitoring and managing Asynq queues and tasks. It provides real-time visibility into the background processing pipeline.</p><h2 id="data-flow" tabindex="-1">Data Flow <a class="header-anchor" href="#data-flow" aria-label="Permalink to &quot;Data Flow&quot;">​</a></h2><ol><li><strong>Ingestion</strong>: Logs are fetched from external sources (e.g., Cloudflare) via background jobs.</li><li><strong>Processing</strong>: The logs are processed, and sensitive data is encrypted using AES-256-GCM.</li><li><strong>Storage</strong>: The processed logs are uploaded to the Garage S3 cluster.</li><li><strong>Retention</strong>: Background workers periodically scan the S3 buckets and delete logs that exceed the configured retention period to ensure compliance (e.g., GDPR, NIS2).</li></ol><h2 id="security" tabindex="-1">Security <a class="header-anchor" href="#security" aria-label="Permalink to &quot;Security&quot;">​</a></h2><ul><li><strong>Encryption at Rest</strong>: Sensitive data, such as API keys, are encrypted before being stored in the database.</li><li><strong>KMS</strong>: A built-in Key Management Service (KMS) handles encryption and decryption operations.</li><li><strong>Sovereignty</strong>: By using Garage S3, data remains within your control, ensuring compliance with data sovereignty regulations.</li></ul>',18)])])}const p=a(n,[["render",i]]);export{u as __pageData,p as default};
